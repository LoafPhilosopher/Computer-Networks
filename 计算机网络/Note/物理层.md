# 计算机网络体系结构

学习的是五层协议的体系结构,此章节物理层对应 OSI 7 层协议体系结构中的物理层,但是在 TCP/IP 协议结构中没有相应的部分,但是可以大致理解为五层协议的体系结构中的数据链路层对应 TCP/IP 中的网络接口层.

# 传输介质与物理层设备

## 非导引型传输媒体与导引型传播介质

### 导引型传播介质

#### 双绞线

![20230903165606](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230903165606.png)

- 组成结构:把两根互相绝缘的铜导线并排放在一起,然后用规则的方法绞合起来就构成了双绞线
- 特点:绞合可以减少对相邻导线的电磁干扰,带宽取决于铜线的粗细和传输的距离.
- 使用情况:最古老但又最常用的传输媒体
- 优势:价格便宜
- 类型:为了进一步提高抗电磁干扰能力,可在双绞线的外面再加上一个由金属丝编织成的屏蔽层,这就是屏蔽双绞线 (STP),无屏蔽层时双绞线就称为非屏蔽双绞线 (UTP).

#### 同轴电缆

![20230903165838](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230903165838.png)

- 组成结构:同轴电缆由导体铜质芯线、绝缘层、网状编织屏蔽层和塑料外层构成
- 使用情况:$50 \Omega$同轴电缆主要用于传送基带数字信号,又称为基带同轴电缆,它在局域网中得到广泛应用；$75 \Omega$同轴电缆主要用于传送宽带信号,又称为宽带同轴电缆,它主要用于有线电视系统.
- 优势:具有很好的抗干扰特性,被广泛用于传输较高速率的数据,其传输距离更远但是价格较双绞线更贵.
- 类型:$50 \Omega$同轴电缆和 $75 \Omega$同轴电缆.

#### 光纤

![20230903171952](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230903171952.png)

- 组成结构:光纤通常由非常透明的石英玻璃拉成细丝,主要由纤芯(实心的)和包层构成双层通信圆柱体.
- 特点:
  - 光纤是光纤通信的传输媒体.通过传递光脉冲来进行通信
  - 发送端：要有光源(发光二极管,半导体激光器等),在电脉冲的作用下能产生出光脉冲.
  - 接收端：要有光检测器,利用光电二极管做成,在检测到光脉冲时还原出电脉冲.
  - 当光线从高折射率的媒体射向低折射率的媒体时,其折射角将大于入射角.如果入射角足够大,就会出现全反射,光也就沿着光纤传输下去.
- 使用情况:
  - 在实际生产中,通常制作为更结实的光缆使用.
  - 非常广泛地应用在计算机网络、电信网络和有线电视网络的主干网络中
- 优势:
  - 通信容量非常大
  - **传输带宽远远大于目前其他各种传输媒体的带宽**
  - 传输损耗小,中继距离长,对远距离传输特别经济
  - 抗雷电和电磁干扰性能好
  - 无串音干扰,保密性好,不易被窃听或截取数据
  - 体积小,重量轻
- 类型
  - 多模光纤:
    ![![20230904074318](httpsyjc-figure.oss-cn-beijing.aliyuncs.com20230904074318.png)](<https://yjc-figure.oss-cn-beijing.aliyuncs.com/![20230904074318](httpsyjc-figure.oss-cn-beijing.aliyuncs.com20230904074318.png).png>)
    - 可以存在多条不同角度入射的光线在一条光纤中传输
    - 光脉冲在多模光纤中传输时会逐渐展宽,造成失真,只适合于近距离传输
  - 单模光纤:
    ![20230904074539](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230904074539.png)
    - 其直径减小到只有一个光的波长（几个微米）,可使光线一直向前传播,而不会产生多次反射
    - 制造成本较高,但衰耗较小
    - 光源要使用昂贵的半导体激光器,不能使用较便宜的发光二极管

### 非导引型传输媒体

#### 无线电波

- 特点:信号向所有方向传播
- 优势:较强穿透能力,可传远距离,灵活性和便携性,实时通信,多用户同时通信,广泛用于通信领域
- 劣势:受干扰影响(无线电通信容易受到外部电磁干扰的影响),容量限制(相对于有线通信,无线电通信的频谱资源是有限的),能耗和电池寿命(无线通信设备通常需要电池供电,而无线通信的功耗较高,会消耗电池能量),安全性和隐私性

#### 微波

- 特点:信号传播方向固定
- 分类:
  - 地面微波接力通信
    - 优势:
      - 微波波段频率很高,频段范围很宽,其通信信道的容量很大
      - 工业干扰和天电干扰对微波通信的危害小,微波传输质量较高
      - 与相同容量和长度的电缆载波通信比较,微波接力通信建设投资少,见效快,易于实施
    - 劣势:带宽有限,受天气影响.
      - 相邻站之间必须直视（常称为视距 LOS (Line Of Sight)）,不能有障碍物,存在多径效应
      - 有时会受到恶劣气候的影响
      - 与电缆通信系统比较,微波通信的隐蔽性和保密性较差
  - 卫星通信
    - 优势:通信容量大,距离远,覆盖广,广播通信和多址通信
    - 劣势:传播时延长(250-270ms)(请注意:"卫星信道的传播时延较大"并不等于"用卫星信道传送数据的时延较大".),受气候影响大 (eg：强风太阳黑子爆发、日凌),误码率高,成本高.

#### 红外线激光

- 特点:信号固定方向传播,把要传输的信号分别转换为各自的信号格式,即红外光信号和激光信号,再在空间中传播.
- 优势:高安全性,成本低
- 劣势:无法透过任何固体物体,不适合于长途通信.

## 物理层设备

### 中继器

#### 功能

- 由于存在损耗,在线路上传输的信号功率会逐渐衰减,衰减到一定程度时将造成信号失真,因此会导致接收错误,因此使用中继器对<font color="red">信号进行还原与再生,对衰减的信号进行放大</font>,保持与原数据相同.以增强信号的传输的距离,延长网络的长度.

#### 特点

- 中继器是用来扩大网络规模的最简单廉价的互连设备
- 中继器两端的网络部分是网段,而不是子网,使用中继器连接的几个网段仍然是一个局域网.中继器若出现故障,对相邻两个网段的工作都将产生影响.
- 由于中继器工作在物理层,因此它不能连接两个具有不同速率的局域网

#### 使用规则

即 5-4-3 规则,在采用粗同轴电缆的 10BASE5 以太网规范中,互相串联的中继器的个数不能超过 4 个,而且用 4 个中继器串联的 5 段通信介质中只有 3 段可以挂接计算机, 其余两段只能用作扩展通信范围的链路段,不能挂接计算机.这就是所调的“5-4-3 规则”.

#### 工作原理

- 信号再生技术,并非将衰减的信号放大.

### 集线器

集线器就是多端口的中继器

# 通信基础

数据通信系统相关模型

![20230822202850](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230822202850.png)

- 调制解调器:将数字信号调制为模拟信号,因为模拟信道它就是能传模拟信号,但是不能传数据字信号的信道.所以我们就需要把这个数字信号转换成模拟信号才能够传过去.

## 物理层基本概念

- 物理层的目标:物理层考虑的是怎样才能在连接各种计算机的传输媒体上<font color="red">传输数据比特流</font>,而不是指具体的传输媒体.
- 物理层的作用：尽可能屏蔽掉不同传输媒体和通信手段的差异.
- 用于物理层的协议也常称为物理层规程(procedure).
- <font color="red">物理层主要任务</font>:确定与传输媒体接口有关的一些特性.即定义标准.确定了下面的四个特性
  - 机械特性:定义物理连接的特性,规定物理连接时所采用的规格、接口形状、引线数目、引脚数量和排列情况.
    ![20230822202132](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230822202132.png)
  - 电气特性:规定传输二进制位时,线路上信号的**电压范围**、阻抗匹配、**传输速率**和**距离限制**等(例如:某网络在物理层规定,信号的电平用 `+10V~+15V`表示二进制`0`,用`-10V~-15V`表示二进制`1`,电线长度限于`15m`以内).
  - 功能特性:指明某条线上**某一电平表示何种意义**,接口部件的信号线的用途(描述一个物理层接口引脚处于高电平时的含义).
  - 规程特性(过程特性):**定义各条物理线路的工作规程和时序关系.指明不同功能的各种可能事件的一个出现顺序**.比如是现转发还是后转发.

### 常用术语

- 消息:语音,文字,图像...
- 数据:运送消息的实体,01010101010
- 信号:数据的电气或电磁的表现,是数据在传输过程中的存在形式
  - 数字信号/离散信号:代表消息的参数的取值是离散的![20230904161255](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230904161255.png)
  - 模拟信号/连续信号:代表消息的参数的取值是连续的![20230904161314](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230904161314.png)
- 信源:产生和发送数据的源头.
- 信宿:接受数据的终点.
- 信道:信号的传输介质.
  - 按传输信号分:模拟信道(传送模拟信号),数字信道(传送数字信号)
  - 按传输介质分:无线信道(微波),有线信道(光纤)
- 噪声源:信道上的噪声(即对信号的干扰)以及分散在通信系统其他各处的噪声的集中表示.
- 信道上传输信号的类型
  - 基带信号:基带信号将数字信号 1 和 0 直接用两种不同的电压表示.然后送到**数字信道**上传输(基带传输).传输距离近.
  - 宽带信号:宽带信号将基带信号进行调制后形成频分复用信号模拟信号,然后传送到**模拟信道**上传输(宽带传输).传输距离远.
- 三种通信方式
  - 单工通信:只有一个方向的通信而没有反方向的交互,仅需要一条信道.例如广播.
  - 半双工通信/双向交替通信:通信的双方都可以发送或接收信息,但任何一方都不能同时发送和接收,需要两条信道.例如对讲机.
  - 全双工通信/双向同时通信:通信双方可以**同时**发送和接受信息,也需要两条信道.例如:打电话.
- 数据传输方式
  - 串行传输:将表示一个字符的 8 位二进制数按由低位到高位的顺序依次发送.费用低,速度慢,适合远距离通信.
  - 并行传输:将表示一个字符的 8 位二进制同时通过 8 条信道发送.速度快,费用高,适合近距离.
- 同步传输:
  ![20230904165231](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230904165231.png)
  - 在同步传输的模式下,数据的传送是以一个**数据区块**为单位,因此同步传输又称为区块传输.在传送数据时,需先送出 1 个或多个同步字符,再送出整批的数据.
  - 在发送端的时候就要添加上这个同步字符.那么接收端在接收的时候,发现了这几个同步字符之后,就可以准备接收了.也就是实现了一个发送方和接收方的时钟同步.
- 异步传输:
  ![20230904165435](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230904165435.png)
  - 异步传输**将比特分成小组进行传送**,小组可以是 8 位的 1 个字符或更长.发送方可以在任何时刻发送这些比特组,而接收方不知道它们会在什么时候到达.传送数据时,加一个字符起始位和一个字符终止位.
    ![20230904165518](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230904165518.png)
  - 同步传输实现同步时要加字符的加同步字符的.而异步传输要实现同步是要加字符起始位和字符终止位.
  - 接收端在接收这个起始位的这样一个过程,其实这就给了接收方响应接收和缓存数据比特的时间.接下来就可以接收这几个这八个比特了.接收完这八个比特之后,它又会收到一个停止位,这一个停止位表示的就是这一次传输信息的终止.
- 码元:
  ![20230904171420](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230904171420.png)
  - 指用一个固定时长的信号波形(数字脉冲),代表不同离散数值的基本波形,是数字通信的计量单位,这个时长内的信号称为 k 进制码元,而该时长称为码元宽度.
  - 一码元可以携带多个 bit 的信息量.
  - 当码元的离散状态有 M 个时(M 大于 2),此时码元为 M 进制码元.$\log_2 k$个比特可以表示 k 进制码元
  - (<font color="red">一个码元=(数字信号)矩形脉冲 or (模拟信号)n 个正余弦周期(1 $\leq$ n))</font>.
- 速率:速率也叫数据的传输速率,表示单位时间内传输的数据量.可以用码元传输速率和信息传输速率表示.
  - 码元传输速率(波特率):码元传输速率：别名码元速率、波形速率、调制速率、符号速率等,它表示单位时间内数字通信系统所传输的码元个数（也可称为脉沖个数或信号变化的次数）,单位是波特（Baud）.主要用于记录 1s 传输多少个码元.码元传输速率只与码元长度有关.
  - 信息传输速率(比特率/信息速率):别名信息速率、比特率等,表示单位时间内数字通信系统传输的二进制码元个数（即比特数）单位是比特/秒 (b/s).1s 传输多少个 bit
  - 关系:若一个码元携带 n bit 的信息量,则 M Baud 的码元传输速率所对应的信息传输速率为$M \times n$ bit/s
- 带宽:
  - 模拟信号系统(不重要):当输入的信号频率高或低到一定程度,使得系统的输出功率成为输入功率的一半时(即-3dB),最高频率和最低频率间的差值就代表了系统的通频带宽,其单位为赫兹(Hz).
  - 数字设备:表示在单位时间内从网络中的某一点到另一点所能通过的"最高数据率"/单位时间内通过链路的数量,常用来表示网络的通信线路所能传输数据的能力.单位是比特每秒(bps).

## <font color="red">奈氏准则与香农定理</font>

<!-- 定理概念 计算公式 适用范围 -->

### 失真

- 真实的信号传播过程中,信道上有带宽限制和噪声干扰的.
- 影响失真的因素:
  - 码元传输速率.那码元传输速率如果越快的话,也就会导致我们这个信号失真的程度就越严重.
  - 信号传输距离.距离越远衰减就越久,干扰也就越久.因此我们对于信号的影响也很大.
  - 噪声干扰.噪声干扰当然越多,我们这个信号就越容易失真.
  - 传输媒体质量.这个传输媒体的质量越差的话,那在接收端接收到这个波形的失真自然也就越严重.
  - 可以看到前面三种其实是正相关,后面这样一种是负相关的关系.
- 码间串扰--失真的现象:接收端收到的信号波形失去了码元之间的清晰界限(发的太快了)

### (奈奎斯特定理)奈氏准则

- 在理想低通（无噪声,带宽受限）条件下,为了避免码间串扰,**极限码元传输速率为 2W Baud**,W 是信道带宽,单位是 Hz.
  ![20230905041221](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905041221.png)
- 在任何信道中,码元传输的速率是有上限的.若传输速率超过此上限,就会出现严重的码间串扰问题,使接收端对码元的完全正确识别成为不可能.
- 信道的频带越宽（即能通过的信号高频分量越多）,就可以用更高的速率进行码元的有效传输
- 奈氏准则给出了码元传输速率的限制,但并没有对信息传输速率给出限制
- 由于码元的传输速率受奈氏准则的制约,所以要提高数据的传输速率,就必须设法使每个码元能携带更多个比特的信息量,这就需要采用多元制的调制方法.

### 香农定理

#### 噪声与信噪比

- 噪声存在于所有的电子设备和通信信道中.由于噪声随机产生,它的瞬时值有时会很大,因此噪声会使接收端对码元的判决产生错误.但是噪声的影响是相对的,若信号较强,那么噪声影响相对较小.因此,**信噪比**就很重要.
- 信噪比=信号的平均功率/噪声的平均功率,常记为 S/N,并用分贝（dB）作为度量单位,即
  $$
  \text{信噪比(dB)}=10 \log_{10}(S/N)
  $$

#### 香农定理具体内容

- 在带宽受限且有噪声的信道中,为了不产生误差,信息的数据传输速率有上限值
  ![20230905043442](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905043442.png)
- 信道的带宽或信道中的信噪比越大,则信息的极限传输速率就越高.
- 只要信息的传输速率低于信道的极限传输速率,就一定能找到某种方法来实现无差错的传输.
- 香农定理得出的为极限信息传输速率,实际信道能达到的传输速率要比它低不少.
- 从香农定理可以看出,若信道带宽 W 或信噪比 S/N 没有上限（不可能）,那么信道的极限信息传输速率也就没有上限.

#### 香农定理与奈氏准则的对比

| 香农定理                                                         | 奈氏准则                            |
| ---------------------------------------------------------------- | ----------------------------------- |
| 带宽受限无噪声条件下,为了避免码间串扰,码元传输速率的上限 2W Baud | 带宽受限有噪声条件下的信息传输速率  |
| 要想提高数据率,就要提高带宽或采用更好的编码技术                  | 要想提高数据率,就要提高带宽或信噪比 |

## 编码与调制

- 将数据变为模拟信号的过程叫做调制
- 将数据变为数字信号的过程叫做编码

### <font color="red">数字数据编码为数字信号</font>

![20230905050248](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905050248.png)

#### 归零编码

- 高电平代表 1,低电平代表 0(或者相反).每个时钟周期的中间跳变到低电平(归零)
- 提供了自同步机制

#### 非归零编码

- 非归零编码 (NRZ)与 RZ 编码的区别是不用归零,一个周期可以全部用来 传输数据.
- NRZ 编码无法传递时钟信号,双方难以同步,因此若想传输高速同步数据, 则需要都带有时钟线.

#### 反向非归零编码

- 反向非归零编码 (NRZI)与 NRZ 编码的区别是用信号的翻转代表 0 信号保持不变代表 1
- 翻转的信号本身可以作为一种通知机制
- USB2.0 用的就是 NRZI 编码

#### 曼彻斯特编码

- 将一个码元分成两个相等的间隔,前一个间隔为高电平而后一个间隔为低电平表示码元 1(前高后低);码元 0 的表示方法则正好相反.当然,也可采用相反的规定.
- 该编码的特点是,在每个码元的中间出现电平跳变,位中间的跳变既作为时钟信号 (可用于同步),又作为数据信号,但它所占的频带宽度是原始基带宽度的两倍(跳的次数太多了).
- 该编码用于以太网

#### 差分曼彻斯特编码

- 差分曼彻斯特编码常用手局域网传输,其规则是:若码元为 1,则前 半个码元的电平与上一码元的后半个码元的电平相同;若码元为 0,则情形相反.
- 在每个码元的中间都有 一次电平的跳转,可以实现自同步,且抗干扰性较好

#### 4B/5B 编码

- 将欲发送数据流的每 4 位作为一组,然后按照 4B/5B 编码规则将其转换成 相应的 5 位码.5 位码共 32 种组合,但只采用其中的 16 种对应 16 种不同的 4 位码,其他 16 种作为控制码 (帧的开始和结束、线路的状态信息等)或保留.

### 数字数据调制为模拟信号

数字数据调制技术在发送端将数字信号转换为模拟信号,而在接收端将模拟信号还原为数字信号,分别对应于调制解调器的调制和解调过程.

![20230905053330](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905053330.png)

- 幅移键控(ASK)
  - 通过改变载波信号的**振幅**来表示数字信号 1 和 0
  - 容易实现,但是抗干扰能力差
- 频移键控(FSK)
  - 通过改变载波信号的**频率**来表示数宇信号 1 和 0,
  - 容易实现,抗干扰能力强,目前应用较为广泛
- 相移键控(PSK)
  - 通过改变载波信号的**相位**来表示数字信号 1 和 0
  - 它又分为绝对调相和相对调相.
- <font color="red">正交振幅调制(QAM)</font>
  - 在频率相同的前提下,将 ASK 与 PSK 结合起来,形成叠加信号.
  - 设波特率为 B,采用 m 个相位,每个相位有 n 种振幅,则该 QAM 技术的数据传输速率 R 为$R = B \log_2(mn)$ 单位为 $ b/s$

### 模拟数据编码为数字信号

![20230905055414](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905055414.png)

- 最典型的例子就是对音频信号进行编码的脉码调制(PCM)
- 主要包括下面三个步骤
  - 采样:对模拟信号周期性扫描,把时间上连续的信号变成时间上离散的信号.为了使所得的离散信号能无失真地代表被抽样的模拟数据,要使用采样定理进行采样$f_{采样频率} \geqslant 2f_{信号最高频率}$
  - 量化:把抽样取得的电平幅值按照一定的分级标度转化为对应的数字值,并取整数,这就把连续的电平幅值转换为离散的数字量.
  - 编码:把量化的结果转换为与之对应的二进制编码

### 模拟数据调制为模拟信号

- 为了实现传输的有效性,可能需要较高的频率.这种调制方式还可以使用频分复用 (FDM) 技术,充分利用带宽资源.
- 比如广播电台,它的这个音频信号声波就要先调制成一个频率比较高的信号,进而可以面对比较大的衰减,还是可以得到一个比较不失真的信号,得到一个原始的基带信号的波形

## <font color="red">电路交换方式与报文交换与分组交换</font>

![20230905081731](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905081731.png)

- 传送数据量大，且传送时间远大于呼叫时，选择电路交换。电路交换传输时延最小。

- 当端到端的通路有很多段的链路组成时， 采用分组交换传送数据较为合适。

- 从信道利用率上看，报文交换和分组交换优于电路交换，其中分组交换比报文交换的时延小，尤其适合于计算机之间的突发式的数据通信。

### 电路交换

![20230905071010](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905071010.png)

#### 电路交换原理

在数据传输期间,源结点与目的结点之间有一条由中间结点构成的专用物理连接线路,在数据传输结束之前,这条线路一直保持.

#### <font color="red">特点</font>

- 电路交换的三个阶段:建立连接 $\to$ 通信 $\to$ 释放连接
- 特点：独占资源,用户始终占用端到端的固定传输带宽.适用于远程批处理信息传输或系统间实时性要求高的大量数据传输的情况.
- 用户始终占用端到端的固定传输带宽.

#### 电路交换优缺点

| 电路交换优点                                                         | 电路交换缺点                                                                                                                                                                                                                                                         |
| -------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 传输时延小                                                           | 建立连接时间长                                                                                                                                                                                                                                                       |
| 数据顺序传送,无失序问题                                              | 线路独占，即使通信线路空闲，也不能供其他用户使用，信道使用效率低。                                                                                                                                                                                                   |
| 实时性强,双方一旦建立物理通路,便可以实时通信,适用于交互式会话类通信. | 灵活性差，双方连接通路中的任何一点出了故障，必须重新拨号建立新连接，不适应突发性通信。                                                                                                                                                                               |
| 全双工通信,没有冲突,通信双方有不同的信道,不会争用物理信道            | 无数据存储能力，难以平滑通信量                                                                                                                                                                                                                                       |
| 适用于模拟信号和数字信号                                             | 电路交换时，数据直达，不同类型、不同规格、不同速率的终端很难相互进行通信(这是指在电路交换当中，电路交换的设备是没有存储能力的那如果有大量数据涌入到这些交换设备当中的时候，这些交换设备没有办法存储，他们也就很难应付数据量的激增，可能会导致一些数据的丢失等等问题) |
| 控制简单,电路的交换设备及控制较简单                                  | 无法发现与纠正传输差错，难以在通信过程中进行差错控制。                                                                                                                                                                                                               |

### 报文交换

![20230905071050](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905071050.png)

#### 报文交换原理

- 报文(message)是网络中交换与传输的教据单元，即站点一次性要发送的数据块。报文包含了将要发送的完整的数据信息，其长短很不一致，长度不限且可变。
- 无需在两个站点之间建立一条专用通路，其数据传输的单位是报文，传送过程采用存储转发方式。

#### 报文交换的优缺点

| 报文交换优点                                                                                                                      | 报文交换缺点                                                                                                                                                                                                                                                  |
| --------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 无需建立连接，无建立连接时延，用户可随时发送报文。                                                                                | 实时性差，不适合传送实时或交互式业务的数据。数据进入交换结点后要经历存储转发过程，从而引起转发时延。                                                                                                                                                          |
| 动态分配线路，动态选择报文通过的最佳路径，可以平滑通信量。                                                                        | 只适用于数字信号。                                                                                                                                                                                                                                            |
| 提高线路可靠性，某条传输路径发生故障，可重新选择另一条路径传输。                                                                  | 由于报文长度没有限制，而每个中间结点都要完整地接收传来的整个报文，当输出线路不空闲时，还可能要存储几个完整报文等待转发，要求网络中每个结点有较大的缓冲区。为了降低成本，减少结点的缓冲存储器的容量，有时要把等待转发的报文存在磁盘上， 进一步增加了传送时延。 |
| 提高线路利用率，通信双方在不同的时间一段一段地部分占有这条物理通道，多个报文可共享信道。                                          |                                                                                                                                                                                                                                                               |
| 提供多目标服务：一个报文可同时发往多个目的地址。                                                                                  |                                                                                                                                                                                                                                                               |
| 在存储转发中容易实现代码转换和速率匹配，甚至收发双方可以不同时处于可用状态。这样就便于类型、 规格和速度不同的计算机之间进行通信。 |                                                                                                                                                                                                                                                               |

### 分组交换

![20230905071508](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230905071508.png)

#### 分组交换的原理

分组交换与报文交换的工作方式基本相同，都采用存储转发方式．形式上的主要差别在于，分组交换网中要限制所传输的数据单位的长度，一般选 128 B。发送节点首先对从终端设备送来的数据报文进行接收、 存储，而后将报文划分成一定长度的分组，并以分组为单位进行传输和交换。接收结点将收到的分组组装成信息或报文。

#### <font color="red">特点</font>

- 分组：大多数计算机网络都不能连续地传送任意长的数据，所以实际上网络系统把数据分割成小块，然后逐块地发送，这种小块就称作分组(packet)。
- 小数据块+控制信息（源和目的地址、编号）=分组

#### 分组交换的优缺点

| 分组交换优点                                                                                                                     | 分组交换缺点                                                                                                                                                                                          |
| -------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 无建立时延，无需为通信双方预先建立一条专用通信线路，用户可随时发送分组。                                                         | 尽管分组交换比报文交换的传输时延少，但仍存在存储转发时延，而且其结点交换机必须具有更强的处理能力。                                                                                                    |
| 线路利用率高，通信双方在不同的时间一段一段地部分占有这条物理通道，多个分组可共享信道。                                           | 每个分组都要加控制信息，一定程度上降低了通信效率，增加了处理的时间。                                                                                                                                  |
| 简化了存储管理。因为分组的长度固定，相应的缓冲区的大小也固定，在交换结点中存储器的管理通常被简化为对缓冲区的管理，相对比较容易。 | 当分组交换采用数据报服务时，可能出现失序、丢失或重复分组，分组到达目的结点时，要对分组按编号进行排序等工作，增加了麻烦。若采用虚电路服务， 虽无失序问题，但有呼叫建立、数据传输和虚电路释放三个过程。 |
| 加速传输，后一个分组的存储可以和前一个分组的转发并行操作；传输一个分组比一份报文所需缓冲区小， 减少等待发送时间。                |                                                                                                                                                                                                       |
| 减少出错几率和重发数据量，提高可靠性，减少传输时延。                                                                             |                                                                                                                                                                                                       |
| 分组短小，适用于计算机之间突发式数据通信。                                                                                       |                                                                                                                                                                                                       |

## <font color="red">数据报与虚电路</font>

分组交换可以细分为面向连接的虚电路方式和无连接的数据报的形式.

### 数据报

![20230908020855](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230908020855.png)

#### 数据报传输数据的方式

- 原主机 A 将报文分为多个分组,依次发送到直接相连的结点(A)
- 结点 A 收到分组后,对每个分组差错检测和路由选择,不同分组的下一跳结点可能不同.
- 结点 C 收到分组 P1 后,对分组 P1 进行差错检测,若正确则向 A 发送确认信息,A 收到 C 确认后则丢弃分组 P1 副本.
- 所有分组到主机 B

#### 数据报方式的特点

- 数据报方式为网络层提供无连接的服务.发送方可随时发送分组,网络中的结点可随时接受分组
  > 无连接服务:不事先为分组的传输确定传输路径,每个分组独立确定传输路径,不同分组传输路径可能不同.
- 同一报文的不同分组达到目的结点时可能发送乱序,重复与丢失
- 每个分组在传输过程中都必须携带源地址和目的地址,以及分组号.
- 分组在交换结点存储转发时,需要排队等待处理.这会带来时延.

### 虚电路

![20230908021852](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230908021852.png)
虚电路之所以是"虚"的，是因为这条电路不是专用的，每个结点到其他结点之间的链路可能同时有若干虚电路通过，也可能同时与多个结点之间建立虚电路。每条虚电路支持特定的两个端系统之间的数据传输，两个端系统之间也可以有多条虚电路为不同的进程服务.

#### 虚电路方式

![20230908022327](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230908022327.png)
![20230908022449](https://yjc-figure.oss-cn-beijing.aliyuncs.com/20230908022449.png)

- 虚电路将数据方式与电路交换方式结合,以发挥两者优点.
- 虚电路工作原理:
  - 为进行数据传输,主机 A 与主机 B 之间先建立一条逻辑通路
  - 虚电路建立后,主机 A 就可向主机 B 发送数据分组
  - 传送结束后主机 A 通过发送"释放请求"分组来拆除虚电路,逐段段开整个连接

#### 虚电路方式的特点

- 虚电路通行链路的建立和拆除需要时间开销
- 虚电路的路由选择体现在连接建立阶段,连接建立后,就确定了传输路径.
- 虚电路提供了可靠的通信功能,能保证每个分组正确且有序到达.

### 数据报服务与虚电路服务的对比

|                    | 数据报服务                 | 虚电路服务                                                |
| ------------------ | -------------------------- | --------------------------------------------------------- |
| 连接的建立         | 不需要                     | 必须有                                                    |
| 目的地址           | 每个分组都有完整的目的地址 | 仅在建立连接阶段使用,之后每个人分组使用长度较短的虚电路号 |
| 路由选择           | 每个分组独立地进行路由选择和转发  | 属于同一条虚电路的分组按照同一路由转发                                                          |
| 分组顺序           |不保证分组的有序到达|保证分组的有序到达                                                           |
| 可靠性             |                       不保证可靠通信,可靠性由用户主机来保证     |可靠性由网络保证                                                           |
| 对网络故障的适应性 |出故障的结点丢失分组，其他分组路径选择发生变化时可以正常传输|所有经过故障结点的虚电路均不能正常工作|
| 差错处理和流量控制 |由用户主机进行流量控制，不保证数据报的可靠性|可由分组交换网负贵，也可由用户主机负责|
